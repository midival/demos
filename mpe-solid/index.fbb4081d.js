const e={context:void 0,registry:void 0};function t(t){e.context=t}const n=(e,t)=>e===t,r=(Symbol("solid-proxy"),Symbol("solid-track")),o=(Symbol("solid-dev-component"),{equals:n});let i=null,s=L;const a=1,u=2,l={owned:null,cleanups:null,context:null,owner:null};var c=null;let h=null,d=null,f=null,p=null,m=null,g=null,C=0;const[v,M]=w(!1);function b(e,t){const n=p,r=c,o=0===e.length,i=o?l:{owned:null,cleanups:null,context:null,owner:void 0===t?r:t},s=o?e:()=>e((()=>S((()=>Z(i)))));c=i,p=null;try{return j(s,!0)}finally{p=n,c=r}}function w(e,t){const n={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},o,t):o).equals||void 0};return[A.bind(n),e=>("function"==typeof e&&(e=h&&h.running&&h.sources.has(n)?e(n.tValue):e(n.value)),_(n,e))]}function P(e,t,n){const r=V(e,t,!1,a);d&&h&&h.running?m.push(r):T(r)}function y(e,t,n){s=R;const r=V(e,t,!1,a),o=N&&q(c,N.id);o&&(r.suspense=o),n&&n.render||(r.user=!0),g?g.push(r):T(r)}function O(e,t,n){n=n?Object.assign({},o,n):o;const r=V(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,d&&h&&h.running?(r.tState=a,m.push(r)):T(r),A.bind(r)}function S(e){if(null===p)return e();const t=p;p=null;try{return e()}finally{p=t}}function I(e){return null===c||(null===c.cleanups?c.cleanups=[e]:c.cleanups.push(e)),e}function B(e){if(h&&h.running)return e(),h.done;const t=p,n=c;return Promise.resolve().then((()=>{let r;return p=t,c=n,(d||N)&&(r=h||(h={sources:new Set,effects:[],promises:new Set,disposed:new Set,queue:new Set,running:!0}),r.done||(r.done=new Promise((e=>r.resolve=e))),r.running=!0),j(e,!1),p=c=null,r?r.done:void 0}))}function E(e,t){const n=Symbol("context");return{id:n,Provider:H(n),defaultValue:e}}function D(e){const t=O(e),n=O((()=>z(t())));return n.toArray=()=>{const e=n();return Array.isArray(e)?e:null!=e?[e]:[]},n}let N;function A(){const e=h&&h.running;if(this.sources&&(e?this.tState:this.state))if((e?this.tState:this.state)===a)T(this);else{const e=m;m=null,j((()=>G(this)),!1),m=e}if(p){const e=this.observers?this.observers.length:0;p.sources?(p.sources.push(this),p.sourceSlots.push(e)):(p.sources=[this],p.sourceSlots=[e]),this.observers?(this.observers.push(p),this.observerSlots.push(p.sources.length-1)):(this.observers=[p],this.observerSlots=[p.sources.length-1])}return e&&h.sources.has(this)?this.tValue:this.value}function _(e,t,n){let r=h&&h.running&&h.sources.has(e)?e.tValue:e.value;if(!e.comparator||!e.comparator(r,t)){if(h){const r=h.running;(r||!n&&h.sources.has(e))&&(h.sources.add(e),e.tValue=t),r||(e.value=t)}else e.value=t;e.observers&&e.observers.length&&j((()=>{for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t],r=h&&h.running;r&&h.disposed.has(n)||((r?n.tState:n.state)||(n.pure?m.push(n):g.push(n),n.observers&&F(n)),r?n.tState=a:n.state=a)}if(m.length>1e6)throw m=[],new Error}),!1)}return t}function T(e){if(!e.fn)return;Z(e);const t=c,n=p,r=C;p=c=e,k(e,h&&h.running&&h.sources.has(e)?e.tValue:e.value,r),h&&!h.running&&h.sources.has(e)&&queueMicrotask((()=>{j((()=>{h&&(h.running=!0),p=c=e,k(e,e.tValue,r),p=c=null}),!1)})),p=n,c=t}function k(e,t,n){let r;try{r=e.fn(t)}catch(t){return e.pure&&(h&&h.running?(e.tState=a,e.tOwned&&e.tOwned.forEach(Z),e.tOwned=void 0):(e.state=a,e.owned&&e.owned.forEach(Z),e.owned=null)),e.updatedAt=n+1,W(t)}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?_(e,r,!0):h&&h.running&&e.pure?(h.sources.add(e),e.tValue=r):e.value=r,e.updatedAt=n)}function V(e,t,n,r=a,o){const i={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:c,context:null,pure:n};if(h&&h.running&&(i.state=0,i.tState=r),null===c||c!==l&&(h&&h.running&&c.pure?c.tOwned?c.tOwned.push(i):c.tOwned=[i]:c.owned?c.owned.push(i):c.owned=[i]),f){const[e,t]=w(void 0,{equals:!1}),n=f(i.fn,t);I((()=>n.dispose()));const r=()=>B(t).then((()=>o.dispose())),o=f(i.fn,r);i.fn=t=>(e(),h&&h.running?o.track(t):n.track(t))}return i}function x(e){const t=h&&h.running;if(0===(t?e.tState:e.state))return;if((t?e.tState:e.state)===u)return G(e);if(e.suspense&&S(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<C);){if(t&&h.disposed.has(e))return;(t?e.tState:e.state)&&n.push(e)}for(let r=n.length-1;r>=0;r--){if(e=n[r],t){let t=e,o=n[r+1];for(;(t=t.owner)&&t!==o;)if(h.disposed.has(t))return}if((t?e.tState:e.state)===a)T(e);else if((t?e.tState:e.state)===u){const t=m;m=null,j((()=>G(e,n[0])),!1),m=t}}}function j(e,t){if(m)return e();let n=!1;t||(m=[]),g?n=!0:g=[],C++;try{const t=e();return function(e){m&&(d&&h&&h.running?function(e){for(let t=0;t<e.length;t++){const n=e[t],r=h.queue;r.has(n)||(r.add(n),d((()=>{r.delete(n),j((()=>{h.running=!0,x(n)}),!1),h&&(h.running=!1)})))}}(m):L(m),m=null);if(e)return;let t;if(h)if(h.promises.size||h.queue.size){if(h.running)return h.running=!1,h.effects.push.apply(h.effects,g),g=null,void M(!0)}else{const e=h.sources,n=h.disposed;g.push.apply(g,h.effects),t=h.resolve;for(const e of g)"tState"in e&&(e.state=e.tState),delete e.tState;h=null,j((()=>{for(const e of n)Z(e);for(const t of e){if(t.value=t.tValue,t.owned)for(let e=0,n=t.owned.length;e<n;e++)Z(t.owned[e]);t.tOwned&&(t.owned=t.tOwned),delete t.tValue,delete t.tOwned,t.tState=0}M(!1)}),!1)}const n=g;g=null,n.length&&j((()=>s(n)),!1);t&&t()}(n),t}catch(e){n||(g=null),m=null,W(e)}}function L(e){for(let t=0;t<e.length;t++)x(e[t])}function R(n){let r,o=0;for(r=0;r<n.length;r++){const e=n[r];e.user?n[o++]=e:x(e)}for(e.context&&t(),r=0;r<o;r++)x(n[r])}function G(e,t){const n=h&&h.running;n?e.tState=0:e.state=0;for(let r=0;r<e.sources.length;r+=1){const o=e.sources[r];if(o.sources){const e=n?o.tState:o.state;e===a?o!==t&&(!o.updatedAt||o.updatedAt<C)&&x(o):e===u&&G(o,t)}}}function F(e){const t=h&&h.running;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(t?r.tState:r.state)||(t?r.tState=u:r.state=u,r.pure?m.push(r):g.push(r),r.observers&&F(r))}}function Z(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),r=t.observers;if(r&&r.length){const e=r.pop(),o=t.observerSlots.pop();n<r.length&&(e.sourceSlots[o]=n,r[n]=e,t.observerSlots[n]=o)}}if(h&&h.running&&e.pure){if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)Z(e.tOwned[t]);delete e.tOwned}K(e,!0)}else if(e.owned){for(t=e.owned.length-1;t>=0;t--)Z(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}h&&h.running?e.tState=0:e.state=0,e.context=null}function K(e,t){if(t||(e.tState=0,h.disposed.add(e)),e.owned)for(let t=0;t<e.owned.length;t++)K(e.owned[t])}function U(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}function $(e,t){for(const n of e)n(t)}function W(e){const t=i&&q(c,i);if(!t)throw e;const n=U(e);g?g.push({fn(){$(t,n)},state:a}):$(t,n)}function q(e,t){return e?e.context&&void 0!==e.context[t]?e.context[t]:q(e.owner,t):void 0}function z(e){if("function"==typeof e&&!e.length)return z(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=z(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function H(e,t){return function(t){let n;return P((()=>n=S((()=>(c.context={[e]:t.value},D((()=>t.children)))))),void 0),n}}const Y=Symbol("fallback");function X(e){for(let t=0;t<e.length;t++)e[t]()}let J=!1;function Q(n,r){if(J&&e.context){const o=e.context;t({...e.context,id:`${e.context.id}${e.context.count++}-`,count:0});const i=S((()=>n(r||{})));return t(o),i}return S((()=>n(r||{})))}const ee=e=>`Stale read from <${e}>.`;function te(e){const t="fallback"in e&&{fallback:()=>e.fallback};return O(function(e,t,n={}){let o=[],i=[],s=[],a=0,u=t.length>1?[]:null;return I((()=>X(s))),()=>{let l,c,h=e()||[];return h[r],S((()=>{let e,t,r,f,p,m,g,C,v,M=h.length;if(0===M)0!==a&&(X(s),s=[],o=[],i=[],a=0,u&&(u=[])),n.fallback&&(o=[Y],i[0]=b((e=>(s[0]=e,n.fallback()))),a=1);else if(0===a){for(i=new Array(M),c=0;c<M;c++)o[c]=h[c],i[c]=b(d);a=M}else{for(r=new Array(M),f=new Array(M),u&&(p=new Array(M)),m=0,g=Math.min(a,M);m<g&&o[m]===h[m];m++);for(g=a-1,C=M-1;g>=m&&C>=m&&o[g]===h[C];g--,C--)r[C]=i[g],f[C]=s[g],u&&(p[C]=u[g]);for(e=new Map,t=new Array(C+1),c=C;c>=m;c--)v=h[c],l=e.get(v),t[c]=void 0===l?-1:l,e.set(v,c);for(l=m;l<=g;l++)v=o[l],c=e.get(v),void 0!==c&&-1!==c?(r[c]=i[l],f[c]=s[l],u&&(p[c]=u[l]),c=t[c],e.set(v,c)):s[l]();for(c=m;c<M;c++)c in r?(i[c]=r[c],s[c]=f[c],u&&(u[c]=p[c],u[c](c))):i[c]=b(d);i=i.slice(0,a=M),o=h.slice(0)}return i}));function d(e){if(s[c]=e,u){const[e,n]=w(c);return u[c]=n,t(h[c],e)}return t(h[c])}}}((()=>e.each),e.children,t||void 0))}function ne(e){const t=e.keyed,n=O((()=>e.when),void 0,{equals:(e,n)=>t?e===n:!e==!n});return O((()=>{const r=n();if(r){const o=e.children;return"function"==typeof o&&o.length>0?S((()=>o(t?r:()=>{if(!S(n))throw ee("Show");return e.when}))):o}return e.fallback}),void 0,void 0)}E();Object.create(null),Object.create(null);const re="_$DX_DELEGATE";function oe(e,t,n,r={}){let o;return b((r=>{o=r,t===document?e():le(t,e(),t.firstChild?null:void 0,n)}),r.owner),()=>{o(),t.textContent=""}}function ie(e,t,n){let r;const o=()=>{const t=document.createElement("template");return t.innerHTML=e,n?t.content.firstChild.firstChild:t.content.firstChild},i=t?()=>(r||(r=o())).cloneNode(!0):()=>S((()=>document.importNode(r||(r=o()),!0)));return i.cloneNode=i,i}function se(e,t=window.document){const n=t[re]||(t[re]=new Set);for(let r=0,o=e.length;r<o;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,ce))}}function ae(e,t){null==t?e.removeAttribute("class"):e.className=t}function ue(e,t,n){return S((()=>e(t,n)))}function le(e,t,n,r){if(void 0===n||r||(r=[]),"function"!=typeof t)return he(e,t,r,n);P((r=>he(e,t(),r,n)),r)}function ce(t){const n=`$$${t.type}`;let r=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==r&&Object.defineProperty(t,"target",{configurable:!0,value:r}),Object.defineProperty(t,"currentTarget",{configurable:!0,get:()=>r||document}),e.registry&&!e.done&&(e.done=_$HY.done=!0);r;){const e=r[n];if(e&&!r.disabled){const o=r[`${n}Data`];if(void 0!==o?e.call(r,o,t):e.call(r,t),t.cancelBubble)return}r=r._$host||r.parentNode||r.host}}function he(t,n,r,o,i){if(e.context){!r&&(r=[...t.childNodes]);let e=[];for(let t=0;t<r.length;t++){const n=r[t];8===n.nodeType&&"!$"===n.data.slice(0,2)?n.remove():e.push(n)}r=e}for(;"function"==typeof r;)r=r();if(n===r)return r;const s=typeof n,a=void 0!==o;if(t=a&&r[0]&&r[0].parentNode||t,"string"===s||"number"===s){if(e.context)return r;if("number"===s&&(n=n.toString()),a){let e=r[0];e&&3===e.nodeType?e.data=n:e=document.createTextNode(n),r=pe(t,r,o,e)}else r=""!==r&&"string"==typeof r?t.firstChild.data=n:t.textContent=n}else if(null==n||"boolean"===s){if(e.context)return r;r=pe(t,r,o)}else{if("function"===s)return P((()=>{let e=n();for(;"function"==typeof e;)e=e();r=he(t,e,r,o)})),()=>r;if(Array.isArray(n)){const s=[],u=r&&Array.isArray(r);if(de(s,n,r,i))return P((()=>r=he(t,s,r,o,!0))),()=>r;if(e.context){if(!s.length)return r;for(let e=0;e<s.length;e++)if(s[e].parentNode)return r=s}if(0===s.length){if(r=pe(t,r,o),a)return r}else u?0===r.length?fe(t,s,o):function(e,t,n){let r=n.length,o=t.length,i=r,s=0,a=0,u=t[o-1].nextSibling,l=null;for(;s<o||a<i;)if(t[s]!==n[a]){for(;t[o-1]===n[i-1];)o--,i--;if(o===s){const t=i<r?a?n[a-1].nextSibling:n[i-a]:u;for(;a<i;)e.insertBefore(n[a++],t)}else if(i===a)for(;s<o;)l&&l.has(t[s])||t[s].remove(),s++;else if(t[s]===n[i-1]&&n[a]===t[o-1]){const r=t[--o].nextSibling;e.insertBefore(n[a++],t[s++].nextSibling),e.insertBefore(n[--i],r),t[o]=n[i]}else{if(!l){l=new Map;let e=a;for(;e<i;)l.set(n[e],e++)}const r=l.get(t[s]);if(null!=r)if(a<r&&r<i){let u,c=s,h=1;for(;++c<o&&c<i&&null!=(u=l.get(t[c]))&&u===r+h;)h++;if(h>r-a){const o=t[s];for(;a<r;)e.insertBefore(n[a++],o)}else e.replaceChild(n[a++],t[s++])}else s++;else t[s++].remove()}}else s++,a++}(t,r,s):(r&&pe(t),fe(t,s));r=s}else if(n.nodeType){if(e.context&&n.parentNode)return r=a?[n]:n;if(Array.isArray(r)){if(a)return r=pe(t,r,o,n);pe(t,r,null,n)}else null!=r&&""!==r&&t.firstChild?t.replaceChild(n,t.firstChild):t.appendChild(n);r=n}else console.warn("Unrecognized value. Skipped inserting",n)}return r}function de(e,t,n,r){let o=!1;for(let i=0,s=t.length;i<s;i++){let s,a=t[i],u=n&&n[i];if(null==a||!0===a||!1===a);else if("object"==(s=typeof a)&&a.nodeType)e.push(a);else if(Array.isArray(a))o=de(e,a,u)||o;else if("function"===s)if(r){for(;"function"==typeof a;)a=a();o=de(e,Array.isArray(a)?a:[a],Array.isArray(u)?u:[u])||o}else e.push(a),o=!0;else{const t=String(a);u&&3===u.nodeType&&u.data===t?e.push(u):e.push(document.createTextNode(t))}}return o}function fe(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function pe(e,t,n,r){if(void 0===n)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let r=!1;for(let i=t.length-1;i>=0;i--){const s=t[i];if(o!==s){const t=s.parentNode===e;r||i?t&&s.remove():t?e.replaceChild(o,s):e.insertBefore(o,n)}else r=!0}}else e.insertBefore(o,n);return[o]}const me=ie("<select>"),ge=ie("<button>Select"),Ce=ie("<option>"),ve=({access:e,onSelect:t})=>{const[n,r]=w([]);let o;y((()=>{const t=e();t&&r((()=>t.inputs))}));const i=()=>{console.log(o),t(n().find((e=>e.id===o.value)))};return[(()=>{const e=me();return"function"==typeof o?ue(o,e):o=e,le(e,(()=>n().map((e=>(()=>{const t=Ce();return le(t,(()=>e.name)),P((()=>t.value=e.id)),t})())))),e})(),(()=>{const e=ge();return e.$$click=i,e})()]};se(["click"]);var Me={};Object.defineProperty(Me,"__esModule",{value:!0}),Me.MIDIValOutput=Me.MIDIValInput=Me.MIDIVal=void 0;var be={},we=be&&be.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(be,"__esModule",{value:!0}),be.MIDIVal=be.matchesConfig=void 0;var Pe={},ye=Pe&&Pe.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.MIDIValInput=void 0;var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.OmnibusRegistrator=Oe.Omnibus=void 0;var Se,Ie={},Be=Ie&&Ie.__classPrivateFieldSet||function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},Ee=Ie&&Ie.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.Omnibus=void 0;var De,Ne,Ae={},_e=Ae&&Ae.__classPrivateFieldSet||function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},Te=Ae&&Ae.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.OmnibusRegistrator=void 0;Ae.OmnibusRegistrator=class{constructor(e){De.set(this,void 0),Ne.set(this,void 0),_e(this,De,e),_e(this,Ne,[])}on(e,t){return Te(this,De).on(e,t),Te(this,Ne).push({name:e,fn:t}),()=>{this.off(e,t)}}off(e,t){if(!Te(this,Ne).find((n=>n.name===e&&n.fn===t)))throw new Error("Event you are trying to unregister was not registered via this Registrator");this.off(e,t),_e(this,Ne,Te(this,Ne).filter((n=>!(n.name===e&&n.fn===t))))}offAll(){Te(this,Ne).forEach((({name:e,fn:t})=>{Te(this,De).off(e,t)})),_e(this,Ne,[])}},De=new WeakMap,Ne=new WeakMap;Ie.Omnibus=class{constructor(){Se.set(this,void 0),Be(this,Se,new Map)}on(e,t){Ee(this,Se).has(e)||Ee(this,Se).set(e,[]);return Ee(this,Se).get(e).push(t),()=>{this.off(e,t)}}off(e,t){const n=Ee(this,Se).get(e)||[];Ee(this,Se).set(e,n.filter((e=>e!==t)))}offAll(){Be(this,Se,new Map)}async trigger(e,...t){const n=Ee(this,Se).get(e)||[];return Promise.all(n.map((e=>e(...t)))).then((()=>{}))}getRegistrator(){return new Ae.OmnibusRegistrator(this)}},Se=new WeakMap,Object.defineProperty(Oe,"Omnibus",{enumerable:!0,get:function(){return Ie.Omnibus}}),Object.defineProperty(Oe,"OmnibusRegistrator",{enumerable:!0,get:function(){return Ae.OmnibusRegistrator}});var ke={};Object.defineProperty(ke,"__esModule",{value:!0}),ke.toMidiMessage=ke.makeMessage=ke.isChannelMode=void 0;ke.isChannelMode=e=>e>=120;ke.makeMessage=({channel:e,command:t,data1:n,data2:r})=>Uint8Array.from([t+(e-1),n,r]);ke.toMidiMessage=([e,t,n])=>{const r=e>>4<<4;return{channel:e-r+1,command:r,data1:t,data2:n}};var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.splitValueIntoFraction=Ve.uIntsIntoNumber=Ve.splitNumberIntoUInt8s=Ve.fractionToPitchBendAsUints=Ve.fractionToPitchBend=void 0;Ve.fractionToPitchBend=e=>{if(e<-1||e>1)throw new Error("Pitch bend value outside the range");return Math.ceil(16383*(e+1)/2)};Ve.fractionToPitchBendAsUints=e=>(0,Ve.splitNumberIntoUInt8s)((0,Ve.fractionToPitchBend)(e));Ve.splitNumberIntoUInt8s=e=>{let t=[];return t[0]=127&e,t[1]=e>>7,t};Ve.uIntsIntoNumber=e=>e[0]+(e[1]<<7);Ve.splitValueIntoFraction=e=>2*((0,Ve.uIntsIntoNumber)(e)/16363-.5);var xe={};Object.defineProperty(xe,"__esModule",{value:!0}),xe.MidiCommand=void 0,xe.MidiCommand={NoteOn:144,NoteOff:128,PolyKeyPressure:160,ControlChange:176,ProgramChange:192,ChannelPressure:208,PitchBend:224,Sysex:240,Clock:{Start:250,Continue:251,Stop:252,Pulse:248}};var je,Le={};Object.defineProperty(Le,"__esModule",{value:!0}),Le.MidiControlChange=void 0,(je=Le.MidiControlChange||(Le.MidiControlChange={}))[je.BankSelect=0]="BankSelect",je[je.ModulationWheel=1]="ModulationWheel",je[je.BreathController=2]="BreathController",je[je.FootController=4]="FootController",je[je.PortamentoTile=5]="PortamentoTile",je[je.DataEntryMSB=6]="DataEntryMSB",je[je.ChannelVolume=7]="ChannelVolume",je[je.Balance=8]="Balance",je[je.Pan=10]="Pan",je[je.ExpressionController=11]="ExpressionController",je[je.EffectControl1=12]="EffectControl1",je[je.EffectControl2=13]="EffectControl2",je[je.GeneralPurposeController1=16]="GeneralPurposeController1",je[je.GeneralPurposeController2=17]="GeneralPurposeController2",je[je.GeneralPurposeController3=18]="GeneralPurposeController3",je[je.GeneralPurposeController4=19]="GeneralPurposeController4",je[je.BankSelectLSB=32]="BankSelectLSB",je[je.ModulationWheelLSB=33]="ModulationWheelLSB",je[je.BreathControllerLSB=34]="BreathControllerLSB",je[je.FootControllerLSB=36]="FootControllerLSB",je[je.PortamentoTileLSB=37]="PortamentoTileLSB",je[je.DataEntryLSB=38]="DataEntryLSB",je[je.ChannelVolumeLSB=39]="ChannelVolumeLSB",je[je.BalanceLSB=40]="BalanceLSB",je[je.PanLSB=42]="PanLSB",je[je.ExpressionControllerLSB=43]="ExpressionControllerLSB",je[je.EffectControl1LSB=48]="EffectControl1LSB",je[je.EffectControl2LSB=49]="EffectControl2LSB",je[je.EffectControl3LSB=50]="EffectControl3LSB",je[je.EffectControl4LSB=51]="EffectControl4LSB",je[je.Sustain=64]="Sustain",je[je.Portamento=65]="Portamento",je[je.Sostenuto=66]="Sostenuto",je[je.SoftPedal=67]="SoftPedal",je[je.LegatoFootswitch=68]="LegatoFootswitch",je[je.Hold2=69]="Hold2",je[je.SoundController1=70]="SoundController1",je[je.SoundController2=71]="SoundController2",je[je.SoundController3=72]="SoundController3",je[je.SoundController4=73]="SoundController4",je[je.SoundController5=74]="SoundController5",je[je.SoundController6=75]="SoundController6",je[je.SoundController7=76]="SoundController7",je[je.SoundController8=77]="SoundController8",je[je.SoundController9=78]="SoundController9",je[je.SoundController10=79]="SoundController10",je[je.SoundVariation=70]="SoundVariation",je[je.TimbreIntensitivity=71]="TimbreIntensitivity",je[je.ReleaseTime=72]="ReleaseTime",je[je.AttackTime=73]="AttackTime",je[je.Brightness=74]="Brightness",je[je.DecayTime=75]="DecayTime",je[je.VibratoRate=76]="VibratoRate",je[je.VibratoDepth=77]="VibratoDepth",je[je.VibratoDelay=78]="VibratoDelay",je[je.GeneralPurposeController5=80]="GeneralPurposeController5",je[je.GeneralPurposeController6=81]="GeneralPurposeController6",je[je.GeneralPurposeController7=82]="GeneralPurposeController7",je[je.GeneralPurposeController8=83]="GeneralPurposeController8",je[je.PortamentoControl=84]="PortamentoControl",je[je.HighResolutionVelocityPrefix=88]="HighResolutionVelocityPrefix",je[je.Effects1Depth=91]="Effects1Depth",je[je.Effects2Depth=92]="Effects2Depth",je[je.Effects3Depth=93]="Effects3Depth",je[je.Effects4Depth=94]="Effects4Depth",je[je.Effects5Depth=95]="Effects5Depth",je[je.DataIncrement=96]="DataIncrement",je[je.DataDecrement=97]="DataDecrement",je[je.NonRegisteredParameterNumberLSB=98]="NonRegisteredParameterNumberLSB",je[je.NonRegisteredParameterNumberMSB=99]="NonRegisteredParameterNumberMSB",je[je.RegisteredParameterNumberLSB=100]="RegisteredParameterNumberLSB",je[je.RegisteredParameterNumberMSB=101]="RegisteredParameterNumberMSB",je[je.AllSoundsOff=120]="AllSoundsOff",je[je.ResetAllControllers=121]="ResetAllControllers",je[je.LocalControlOnOff=122]="LocalControlOnOff",je[je.AllNotesOff=123]="AllNotesOff",je[je.OmniModeOff=124]="OmniModeOff",je[je.OmniModeOn=125]="OmniModeOn",je[je.MonoModeOn=126]="MonoModeOn",je[je.PolyModeOn=127]="PolyModeOn";var Re={};Object.defineProperty(Re,"__esModule",{value:!0}),Re.ticksToBPM=Re.quarternoteToBPM=Re.averageIntervals=Re.computeIntervalsInMs=void 0;const Ge=(e,t)=>e+t;Re.computeIntervalsInMs=e=>{const t=[];for(let n=1;n<e.length;n++)t.push(e[n]-e[n-1]);return t};Re.averageIntervals=e=>e&&e.length?e.reduce(Ge)/e.length:0;Re.quarternoteToBPM=e=>6e4/(24*e);Re.ticksToBPM=e=>!e||e.length<2?0:(0,Re.quarternoteToBPM)((0,Re.averageIntervals)((0,Re.computeIntervalsInMs)(e)));var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.MIDIValConfigurationError=Fe.MIDIValError=void 0;class Ze extends Error{constructor(e){super(e)}get name(){return this.constructor.name}}Fe.MIDIValError=Ze;Fe.MIDIValConfigurationError=class extends Ze{};var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.toProgramMessage=Ke.toControlChangeMessage=Ke.toNoteMessage=void 0;Ke.toNoteMessage=e=>Object.assign(Object.assign({},e),{note:e.data1,velocity:e.data2});Ke.toControlChangeMessage=e=>Object.assign(Object.assign({},e),{control:e.data1,value:e.data2});Ke.toProgramMessage=e=>Object.assign(Object.assign({},e),{program:e.data1,value:e.data2});var Ue={};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.toRegisteredParameterKey=Ue.MIDIRegisteredParameters=void 0,Ue.MIDIRegisteredParameters={PITCH_BEND_SENSITIVITY:[0,0],CHANNEL_FINE_TUNING:[0,1],CHANNEL_COARSE_TUNING:[0,2],TUNING_PROGRAM_CHANGE:[0,3],TUNING_BANK_SELECT:[0,4],MODULATION_DEPTH_CHANGE:[0,5],MPE_CONFIGURATION_MESSAGE:[0,6]};Ue.toRegisteredParameterKey=e=>{for(const[t,n]of Object.entries(Ue.MIDIRegisteredParameters))if(n[0]===e[0]&&n[1]===e[1])return t;throw new Error("Unknown registered parameter")};const $e={computeClockTempo:!1};class We{constructor(e,t=$e){this.rpn=[-1,-1],this.omnibus=new Oe.Omnibus,this.tempoSamples=[],this.registerInput(e),this.options=t}static fromInterfaceId(e,t){return ye(this,void 0,void 0,(function*(){const n=(yield this.getMidiAccess()).inputs.find((({id:t})=>t===e));if(!n)throw new Fe.MIDIValError(`${e} not found`);return new We(n,t)}))}static fromInterfaceName(e,t){return ye(this,void 0,void 0,(function*(){const n=(yield this.getMidiAccess()).inputs.find((({name:t})=>t===e));if(!n)throw new Fe.MIDIValError(`${e} not found`);return new We(n,t)}))}static getMidiAccess(){return ye(this,void 0,void 0,(function*(){return yield Me.MIDIVal.connect()}))}get tempo(){if(!this.options.computeClockTempo)throw new Fe.MIDIValConfigurationError("To use MIDIValInput.tempo you need to enable computeClockTempo option.");return(0,Re.ticksToBPM)(this.tempoSamples)}registerInput(e){return ye(this,void 0,void 0,(function*(){if(this.midiInput=e,this.unregisterInput=yield e.onMessage((e=>{if(240===e.data[0])return void this.omnibus.trigger("sysex",e.data);if(this.isClockCommand(e))return;const t=(0,ke.toMidiMessage)(e.data);switch(t.command){case xe.MidiCommand.NoteOn:this.omnibus.trigger("noteOn",(0,Ke.toNoteMessage)(t));break;case xe.MidiCommand.NoteOff:this.omnibus.trigger("noteOff",(0,Ke.toNoteMessage)(t));break;case xe.MidiCommand.ControlChange:this.omnibus.trigger("controlChange",(0,Ke.toControlChangeMessage)(t));break;case xe.MidiCommand.ProgramChange:this.omnibus.trigger("programChange",(0,Ke.toProgramMessage)(t));break;case xe.MidiCommand.PolyKeyPressure:this.omnibus.trigger("polyKeyPressure",t);break;case xe.MidiCommand.PitchBend:this.omnibus.trigger("pitchBend",{channel:t.channel,value:(0,Ve.splitValueIntoFraction)([t.data1,t.data2])});break;case xe.MidiCommand.ChannelPressure:this.omnibus.trigger("channelPressure",t);break;default:console.log("unknown msg",t)}})),this.options.computeClockTempo){this.onClockPulse((()=>{this.tempoSamples.push(performance.now()),this.tempoSamples.length>20&&this.tempoSamples.shift()}));const e=()=>{this.tempoSamples=[]};this.onClockContinue(e),this.onClockStart(e)}this.onControlChange(Le.MidiControlChange.RegisteredParameterNumberMSB,(e=>{this.rpn=[e.data2,this.rpn[1]]})),this.onControlChange(Le.MidiControlChange.RegisteredParameterNumberLSB,(e=>{this.rpn=[this.rpn[0],e.data2]})),this.onControlChange(Le.MidiControlChange.DataEntryMSB,(e=>{const t=(0,Ue.toRegisteredParameterKey)(this.rpn);this.omnibus.trigger("registeredParameterData",{channel:e.channel,parameter:t,msb:e.data2,lsb:null})})),this.onControlChange(Le.MidiControlChange.DataEntryLSB,(e=>{const t=(0,Ue.toRegisteredParameterKey)(this.rpn);this.omnibus.trigger("registeredParameterData",{channel:e.channel,parameter:t,msb:null,lsb:e.data2})}))}))}isClockCommand(e){switch(e.data[0]){case xe.MidiCommand.Clock.Pulse:return this.omnibus.trigger("clockPulse"),!0;case xe.MidiCommand.Clock.Start:return this.omnibus.trigger("clockStart"),!0;case xe.MidiCommand.Clock.Continue:return this.omnibus.trigger("clockContinue"),!0;case xe.MidiCommand.Clock.Stop:return this.omnibus.trigger("clockStop"),!0;default:return!1}}onBusKeyValue(e,t,n,r){return this.omnibus.on(e,((...e)=>{if(!e.length)return;const o=e[0];o[t]===n&&r(o)}))}disconnect(){this.omnibus.offAll(),this.unregisterInput&&this.unregisterInput()}onAllNoteOn(e){return this.omnibus.on("noteOn",e)}onNoteOn(e,t){return this.omnibus.on("noteOn",(n=>{if(n.note===e)return t(n)}))}onAllNoteOff(e){return this.omnibus.on("noteOff",e)}onNoteOff(e,t){return this.onBusKeyValue("noteOff","note",e,t)}onPitchBend(e){return this.omnibus.on("pitchBend",e)}onAllControlChange(e){return this.omnibus.on("controlChange",e)}onControlChange(e,t){return(0,ke.isChannelMode)(e)&&console.warn("use designated Channel Mode callback instead of onControlChange for "+e),this.omnibus.on("controlChange",(n=>{n.control===e&&t(n)}))}onAllProgramChange(e){return this.omnibus.on("programChange",e)}onProgramChange(e,t){return this.onBusKeyValue("programChange","program",e,t)}onAllPolyKeyPressure(e){return this.omnibus.on("polyKeyPressure",e)}onPolyKeyPressure(e,t){return this.onBusKeyValue("polyKeyPressure","data1",e,t)}onSysex(e){return this.omnibus.on("sysex",e)}onAllSoundsOff(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.AllSoundsOff,e)}onResetAllControllers(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.ResetAllControllers,e)}onLocalControlChange(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.LocalControlOnOff,(t=>{e(127===t.data2,t)}))}onAllNotesOff(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.AllNotesOff,e)}onChannelPressure(e){return this.omnibus.on("channelPressure",e)}onOmniModeOff(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.OmniModeOff,e)}onOmniModeOn(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.OmniModeOn,e)}onMonoModeOn(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.MonoModeOn,e)}onPolyModeOn(e){return this.onBusKeyValue("controlChange","control",Le.MidiControlChange.PolyModeOn,e)}onClockPulse(e){return this.omnibus.on("clockPulse",e)}onClockStart(e){return this.omnibus.on("clockStart",e)}onClockStop(e){return this.omnibus.on("clockStop",e)}onClockContinue(e){return this.omnibus.on("clockContinue",e)}onMpeConfiguration(e){return this.onBusKeyValue("registeredParameterData","parameter","MPE_CONFIGURATION_MESSAGE",e)}onPitchBendSensitivity(e){return this.onBusKeyValue("registeredParameterData","parameter","PITCH_BEND_SENSITIVITY",e)}onChannelFineTuning(e){return this.onBusKeyValue("registeredParameterData","parameter","CHANNEL_FINE_TUNING",e)}onChannelCoarseTuning(e){return this.onBusKeyValue("registeredParameterData","parameter","CHANNEL_COARSE_TUNING",e)}onTuningProgramChange(e){return this.onBusKeyValue("registeredParameterData","parameter","TUNING_PROGRAM_CHANGE",e)}onTuningBankChange(e){return this.onBusKeyValue("registeredParameterData","parameter","TUNING_BANK_SELECT",e)}onModulationDepthChange(e){return this.onBusKeyValue("registeredParameterData","parameter","MODULATION_DEPTH_CHANGE",e)}}Pe.MIDIValInput=We;var qe={},ze=qe&&qe.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(qe,"__esModule",{value:!0}),qe.MIDIValOutput=void 0;const He=e=>new Promise((t=>setInterval(t,e)));class Ye{constructor(e){this.midiOutput=e,this.defaultChannel=1}send(e){this.midiOutput&&this.midiOutput.send(e)}setChannel(e){this.defaultChannel=e}getChannel(e){return e?e-1:this.defaultChannel-1}static fromInterfaceName(e){return ze(this,void 0,void 0,(function*(){const t=(yield this.getMidiAccess()).outputs.find((({name:t})=>t===e));if(!t)throw new Error(`${e} not found`);return new Ye(t)}))}static getMidiAccess(){return ze(this,void 0,void 0,(function*(){return yield Me.MIDIVal.connect()}))}sendNoteOn(e,t,n){return this.send([xe.MidiCommand.NoteOn+this.getChannel(n),e,t])}sendNoteOff(e,t){return this.send([xe.MidiCommand.NoteOff+this.getChannel(t),e,0])}sendPolyKeyPressure(e,t,n){return this.send([xe.MidiCommand.PolyKeyPressure+this.getChannel(n),e,t])}sendControlChange(e,t,n){return this.send([xe.MidiCommand.ControlChange+this.getChannel(n),e,t])}sendProgramChange(e,t){return this.send([xe.MidiCommand.ProgramChange+this.getChannel(t),e])}sendChannelPressure(e,t){return this.send([xe.MidiCommand.ChannelPressure+this.getChannel(t),e])}sendPitchBend(e,t){return this.send(new Uint8Array([xe.MidiCommand.PitchBend+this.getChannel(t),...(0,Ve.fractionToPitchBendAsUints)(e)]))}sendAllSoundOff(e){return this.send([xe.MidiCommand.ControlChange+this.getChannel(e),Le.MidiControlChange.AllSoundsOff,0])}sendResetAllControllers(e){return this.send([xe.MidiCommand.ControlChange+this.getChannel(e),Le.MidiControlChange.ResetAllControllers,0])}sendLocalControlOff(e){return this.send([xe.MidiCommand.ControlChange+this.getChannel(e),Le.MidiControlChange.LocalControlOnOff,0])}sendLocalControlOn(e){return this.send([xe.MidiCommand.ControlChange+this.getChannel(e),Le.MidiControlChange.LocalControlOnOff,127])}sendAllNotesOff(e){return this.send([xe.MidiCommand.ControlChange+this.getChannel(e),Le.MidiControlChange.AllNotesOff,0])}sendClockStart(){return this.send([xe.MidiCommand.Clock.Start])}sendClockStop(){return this.send([xe.MidiCommand.Clock.Stop])}sendClockContinue(){return this.send([xe.MidiCommand.Clock.Continue])}sendClockPulse(){return this.send([xe.MidiCommand.Clock.Pulse])}sendRPNSelection([e,t],n){this.sendControlChange(Le.MidiControlChange.RegisteredParameterNumberMSB,e,n),this.sendControlChange(Le.MidiControlChange.RegisteredParameterNumberLSB,t,n)}sendRPDataMSB(e,t){this.sendControlChange(Le.MidiControlChange.DataEntryMSB,e,t)}sendRPDataLSB(e,t){this.sendControlChange(Le.MidiControlChange.DataEntryLSB,e,t)}incrementRPData(e,t){this.sendControlChange(Le.MidiControlChange.DataIncrement,e,t)}decrementRPData(e,t){this.sendControlChange(Le.MidiControlChange.DataDecrement,e,t)}sendRPNNull(){}initializeMPE(e,t,n=100){return ze(this,void 0,void 0,(function*(){this.sendRPNSelection(Ue.MIDIRegisteredParameters.MPE_CONFIGURATION_MESSAGE,1),yield He(n),this.sendRPDataMSB(e,1),yield He(n),this.sendRPDataMSB(t,16),yield He(n),this.sendRPNNull(),yield He(n)}))}setPitchBendSensitivity(e,t,n,r=100){return ze(this,void 0,void 0,(function*(){this.sendRPNSelection(Ue.MIDIRegisteredParameters.PITCH_BEND_SENSITIVITY,n),yield He(r),this.sendRPDataMSB(e,n),yield He(r),this.sendRPNNull()}))}}qe.MIDIValOutput=Ye;var Xe={},Je=Xe&&Xe.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.BrowserMIDIAccess=void 0;var Qe={};Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.BrowserMIDIOutput=void 0;Qe.BrowserMIDIOutput=class{constructor(e){this.output=e}send(e){this.output.send(e)}get id(){return this.output.id}get name(){return this.output.name}get manufacturer(){return this.output.manufacturer}};var et={},tt=et&&et.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(et,"__esModule",{value:!0}),et.BrowserMIDIInput=void 0;et.BrowserMIDIInput=class{constructor(e){this.input=e}onMessage(e){return tt(this,void 0,void 0,(function*(){return yield this.input.open(),this.input.addEventListener("midimessage",e),()=>{this.input.removeEventListener("midimessage",e)}}))}get id(){return this.input.id}get name(){return this.input.name}get manufacturer(){return this.input.manufacturer}};Xe.BrowserMIDIAccess=class{constructor(){this.bus=new Oe.Omnibus}onInputConnected(e){return this.bus.on("inputConnected",e)}onInputDisconnected(e){return this.bus.on("inputDisconnected",e)}onOutputConnected(e){return this.bus.on("outputConnected",e)}onOutputDisconnected(e){return this.bus.on("outputDisconnected",e)}connect(e=!1){return Je(this,void 0,void 0,(function*(){if(!navigator.requestMIDIAccess)throw new Error("requestMIDIAccess not available, make sure you are using MIDI-compatible browser.");this.access=yield navigator.requestMIDIAccess({sysex:e}),this.listenOnStateChange()}))}get outputs(){return Array.from(this.access.outputs).map((([,e])=>new Qe.BrowserMIDIOutput(e)))}get inputs(){return Array.from(this.access.inputs).map((([,e])=>new et.BrowserMIDIInput(e)))}getInputById(e){const t=Array.from(this.access.inputs).map((([,e])=>e)).find((({id:t})=>t===e));if(!t)throw new Error(`Cannot find input ${e}`);return new et.BrowserMIDIInput(t)}getOutputById(e){const t=Array.from(this.access.outputs).map((([,e])=>e)).find((({id:t})=>t===e));if(!t)throw new Error(`Cannot find output ${e}`);return new Qe.BrowserMIDIOutput(t)}listenOnStateChange(){this.access.addEventListener("statechange",(e=>{if("input"===e.port.type)switch(e.port.state){case"disconnected":this.bus.trigger("inputDisconnected",new et.BrowserMIDIInput(e.port));break;case"connected":this.bus.trigger("inputConnected",new et.BrowserMIDIInput(e.port))}else switch(e.port.state){case"disconnected":this.bus.trigger("outputDisconnected",new Qe.BrowserMIDIOutput(e.port));break;case"connected":this.bus.trigger("outputConnected",new Qe.BrowserMIDIOutput(e.port))}}))}};be.matchesConfig=(e,t)=>Object.keys(t).reduce(((n,r)=>{const o=t[r];return"string"==typeof o?n&&e[r]===o:n&&o.test(e[r])}),!0);class nt{static configureAccessObject(e){this.isSetupComplete=!1,this.accessObject=e}static onInputDeviceConnected(e,t=!1){return we(this,void 0,void 0,(function*(){return t&&this.accessObject.inputs.forEach(e),this.accessObject.onInputConnected(e)}))}static onInputDeviceWithConfigConnected(e,t,n=!1){return we(this,void 0,void 0,(function*(){return this.onInputDeviceConnected((n=>{(0,be.matchesConfig)(n,e)&&t(new Pe.MIDIValInput(n))}),n)}))}static onOutputDeviceWithConfigConnected(e,t,n=!1){return we(this,void 0,void 0,(function*(){return this.onOutputDeviceConnected((n=>{(0,be.matchesConfig)(n,e)&&t(new qe.MIDIValOutput(n))}),n)}))}static onOutputDeviceConnected(e,t=!1){return we(this,void 0,void 0,(function*(){return t&&this.accessObject.outputs.forEach(e),this.accessObject.onOutputConnected(e)}))}static onInputDeviceDisconnected(e){return we(this,void 0,void 0,(function*(){return this.accessObject.onInputDisconnected(e)}))}static onOutputDeviceDisconnected(e){return we(this,void 0,void 0,(function*(){return this.accessObject.onOutputDisconnected(e)}))}static fromMIDIInput(e){return new Pe.MIDIValInput(e)}static fromMIDIOutput(e){return new qe.MIDIValOutput(e)}static connect(){return we(this,void 0,void 0,(function*(){return yield this.setupDeviceWatchers(),this.accessObject}))}static setupDeviceWatchers(){return we(this,void 0,void 0,(function*(){this.isSetupComplete||(this.isSetupComplete=!0,this.accessObject||(this.accessObject=new Xe.BrowserMIDIAccess),yield this.accessObject.connect())}))}}nt.isSetupComplete=!1,be.MIDIVal=nt,Object.defineProperty(Me,"MIDIVal",{enumerable:!0,get:function(){return be.MIDIVal}}),Object.defineProperty(Me,"MIDIValInput",{enumerable:!0,get:function(){return Pe.MIDIValInput}}),Object.defineProperty(Me,"MIDIValOutput",{enumerable:!0,get:function(){return qe.MIDIValOutput}});const rt=ie("<h1>Dashboard "),ot=ie("<div>"),it=ie("<div><div>Note:</div><div>Velocity: </div><div>Channel: "),st=({input:e})=>{const[t,n]=w([]),r=new(0,Me.MIDIValInput)(e);return r.onAllNoteOn((e=>{n((t=>[...t,e]))})),r.onAllNoteOff((e=>{n((t=>t.filter((t=>t.note!==e.note))))})),[(()=>{const t=rt();t.firstChild;return le(t,(()=>e.name),null),t})(),(()=>{const e=ot();return le(e,Q(te,{get each(){return t()},children:e=>(()=>{const t=it(),n=t.firstChild,r=(n.firstChild,n.nextSibling),o=(r.firstChild,r.nextSibling);o.firstChild;return le(n,(()=>e.note),null),le(r,(()=>e.velocity),null),le(o,(()=>e.channel),null),P((()=>ae(t,"qzj8Cq_note"))),t})()})),P((()=>ae(e,"qzj8Cq_notesContainer"))),e})()]},at=ie("<select>"),ut=ie("<button>Select"),lt=ie("<option>"),ct=({access:e,onSelect:t})=>{const[n,r]=w([]);let o;y((()=>{const t=e();t&&r((()=>t.outputs))}));const i=()=>{console.log(o),t(n().find((e=>e.id===o.value)))};return[(()=>{const e=at();return"function"==typeof o?ue(o,e):o=e,le(e,(()=>n().map((e=>(()=>{const t=lt();return le(t,(()=>e.name)),P((()=>t.value=e.id)),t})())))),e})(),(()=>{const e=ut();return e.$$click=i,e})()]};se(["click"]);var ht={};Object.defineProperty(ht,"__esModule",{value:!0}),ht.ActiveNote=ht.MPEOutputZone=ht.MPEMidivalOutput=ht.MPEInputZone=ht.MPEMidivalInput=void 0;var dt,ft,pt={},mt=pt&&pt.__classPrivateFieldSet||function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},gt=pt&&pt.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(pt,"__esModule",{value:!0}),pt.MPEMidivalInput=void 0;var Ct,vt,Mt,bt={},wt=bt&&bt.__classPrivateFieldSet||function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Pt=bt&&bt.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(bt,"__esModule",{value:!0}),bt.MPEInputZone=void 0;bt.MPEInputZone=class{constructor(e,t,n){this.masterChannel=e,this.memberChannelRange=t,this.input=n,this.eventBus=new Oe.Omnibus,Ct.set(this,0),vt.set(this,0),Mt.set(this,0),this.bindEvents()}bindEvents(){const[e,t]=this.memberChannelRange;this.input.onAllNoteOn((n=>{n.channel>=e&&n.channel<=t&&this.eventBus.trigger("noteOn",n)})),this.input.onAllNoteOff((n=>{n.channel>=e&&n.channel<=t&&this.eventBus.trigger("noteOff",n)})),this.input.onPitchBend((n=>{if(n.channel===this.masterChannel)return this.eventBus.trigger("masterPitchBend",n),void wt(this,Ct,n.value,"f");n.channel>=e&&n.channel<=t&&this.eventBus.trigger("memberPitchBend",{channel:n.channel,memberPitchBend:n.value,masterPitchBend:Pt(this,Ct,"f")})})),this.input.onChannelPressure((n=>{if(n.channel===this.masterChannel)return this.eventBus.trigger("masterPressure",{channel:n.channel,value:n.data2}),void wt(this,Mt,n.data2,"f");n.channel>=e&&n.channel<=t&&this.eventBus.trigger("memberPressure",{channel:n.channel,memberPressure:n.data2,masterPressure:Pt(this,Mt,"f")})})),this.input.onControlChange(74,(n=>{if(n.channel===this.masterChannel)return this.eventBus.trigger("masterTimbre",{channel:n.channel,value:n.data2}),void wt(this,vt,n.data2,"f");n.channel>=e&&n.channel<=t&&this.eventBus.trigger("memberTimbre",{channel:n.channel,memberTimbre:n.data2,masterTimbre:Pt(this,vt,"f")})}))}onNoteOn(e){return this.eventBus.on("noteOn",e)}onNoteOff(e){return this.eventBus.on("noteOff",e)}onMasterPitchBend(e){return this.eventBus.on("masterPitchBend",e)}onMemberPitchBend(e){return this.eventBus.on("memberPitchBend",e)}onMasterTimbre(e){return this.eventBus.on("masterTimbre",e)}onMemberTimbre(e){return this.eventBus.on("memberTimbre",e)}onMasterPressure(e){return this.eventBus.on("masterPressure",e)}onMemberPressure(e){return this.eventBus.on("memberPressure",e)}},Ct=new WeakMap,vt=new WeakMap,Mt=new WeakMap;pt.MPEMidivalInput=class{constructor(e){this.eventBus=new Oe.Omnibus,dt.set(this,void 0),ft.set(this,void 0),e.onMpeConfiguration((({channel:t,msb:n})=>{1===t&&(mt(this,dt,n?new bt.MPEInputZone(t,[2,1+n],e):null,"f"),this.eventBus.trigger("lowerZoneUpdate",gt(this,dt,"f"))),16===t&&(mt(this,ft,n?new bt.MPEInputZone(t,[15-n,15],e):null,"f"),this.eventBus.trigger("upperZoneUpdate",gt(this,ft,"f")))}))}get isMpeEnabled(){return null!==gt(this,dt,"f")||null!==gt(this,ft,"f")}get lowerZone(){return gt(this,dt,"f")}get upperZone(){return gt(this,ft,"f")}onLowerZoneUpdate(e){return this.eventBus.on("lowerZoneUpdate",e)}onUpperZoneUpdate(e){return this.eventBus.on("upperZoneUpdate",e)}},dt=new WeakMap,ft=new WeakMap,Object.defineProperty(ht,"MPEMidivalInput",{enumerable:!0,get:function(){return pt.MPEMidivalInput}}),Object.defineProperty(ht,"MPEInputZone",{enumerable:!0,get:function(){return bt.MPEInputZone}});var yt,Ot,St={},It=St&&St.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Bt=St&&St.__classPrivateFieldSet||function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n};Object.defineProperty(St,"__esModule",{value:!0}),St.MPEMidivalOutput=void 0;var Et,Dt={},Nt=Dt&&Dt.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},At=Dt&&Dt.__classPrivateFieldSet||function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.MPEOutputZone=void 0;var _t,Tt,kt,Vt,xt={},jt=xt&&xt.__classPrivateFieldSet||function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Lt=xt&&xt.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(xt,"__esModule",{value:!0}),xt.ActiveNote=void 0;xt.ActiveNote=class{constructor(e,t,n,r){this.note=e,this.velocity=t,this.channel=n,this.output=r,_t.set(this,0),Tt.set(this,0),kt.set(this,0),Vt.set(this,!0),this.output.sendNoteOn(e,t,n)}changePressure(e){this.isActive&&(this.output.sendChannelPressure(e,this.channel),jt(this,kt,e,"f"))}changeBend(e){this.isActive&&(this.output.sendPitchBend(e,this.channel),jt(this,_t,e,"f"))}changeTimbre(e){this.isActive&&(this.output.sendControlChange(74,e,this.channel),jt(this,Tt,e,"f"))}get x(){return Lt(this,_t,"f")}get y(){return Lt(this,Tt,"f")}get z(){return Lt(this,kt,"f")}set x(e){this.changeBend(e)}set y(e){this.changeTimbre(e)}set z(e){this.changePressure(e)}get pitchBend(){return Lt(this,_t,"f")}get timbre(){return Lt(this,Tt,"f")}get pressure(){return Lt(this,kt,"f")}get isActive(){return Lt(this,Vt,"f")}noteOff(){this.output.sendNoteOff(this.note,this.channel),jt(this,Vt,!1,"f")}},_t=new WeakMap,Tt=new WeakMap,kt=new WeakMap,Vt=new WeakMap;Dt.MPEOutputZone=class{constructor(e,t,n){this.masterChannel=e,this.childChannelsRange=t,this.output=n,Et.set(this,[])}getOpenChannel(){const e=this.notesPerChannel,t=Math.min(...Array.from(e.values()));for(const[n,r]of e.entries())if(r===t)return n}forEachMember(e){const[t,n]=this.childChannelsRange;for(let r=t;r<n;r++)e(r)}get notesPerChannel(){const[e,t]=this.childChannelsRange,n=new Map;for(let r=e;r<t;r++)n.set(r,0);return Nt(this,Et,"f").forEach((e=>{n.set(e.channel,n.get(e.channel)+1)})),At(this,Et,Nt(this,Et,"f").filter((e=>e.isActive)),"f"),n}setMasterPitchBend(e){this.output.sendPitchBend(e,this.masterChannel)}setMasterTimbre(e){this.output.sendControlChange(74,e,this.masterChannel)}setMasterVelocity(e){this.output.sendChannelPressure(e,this.masterChannel)}setMasterPitchBendSensitivity(e){this.output.setPitchBendSensitivity(e,0,this.masterChannel)}setMemberPitchBendSensitivity(e){this.forEachMember((t=>{this.output.setPitchBendSensitivity(e,0,t)}))}sendNoteOn(e,t){const n=this.getOpenChannel(),r=new xt.ActiveNote(e,t,n,this.output);return Nt(this,Et,"f").push(r),r}},Et=new WeakMap;St.MPEMidivalOutput=class{get lowerZone(){return It(this,yt,"f")}get upperZone(){return It(this,Ot,"f")}constructor(e,t){this.options=t,yt.set(this,null),Ot.set(this,null),this.midivalOutput=new qe.MIDIValOutput(e),this.midivalOutput.initializeMPE(this.options.lowerZoneSize||0,this.options.upperZoneSize||0,10),this.options.lowerZoneSize&&Bt(this,yt,new Dt.MPEOutputZone(1,[2,2+this.options.lowerZoneSize],this.midivalOutput),"f"),this.options.upperZoneSize&&Bt(this,Ot,new Dt.MPEOutputZone(16,[15-this.options.upperZoneSize,15],this.midivalOutput),"f")}disconnect(){this.midivalOutput.initializeMPE(0,0),Bt(this,yt,null,"f"),Bt(this,Ot,null,"f")}},yt=new WeakMap,Ot=new WeakMap,Object.defineProperty(ht,"MPEMidivalOutput",{enumerable:!0,get:function(){return St.MPEMidivalOutput}}),Object.defineProperty(ht,"MPEOutputZone",{enumerable:!0,get:function(){return Dt.MPEOutputZone}}),Object.defineProperty(ht,"ActiveNote",{enumerable:!0,get:function(){return xt.ActiveNote}});const Rt=ie("<div>Note: <br>Channel: <br>X: <br>Y: <br>Z: <br><button></button><br><button></button><button></button><button>"),Gt=ie("<div>"),Ft=e=>e,Zt=({value:e,mpe:t})=>{const[n,r]=w(null,{equals:!1}),[o,i]=w(0),[s,a]=w(0),[u,l]=w(0),c=()=>{r(t.lowerZone.sendNoteOn(e,100))},h=()=>{o()?i(0):(i(Math.random()),d())},d=()=>{if(!o())return;const e=Math.sin(Date.now()/(500*Math.PI)+200*o());n().x=.5*e,r(Ft),setTimeout(d,50)},f=()=>{s()?a(0):(a(Math.random()),p())},p=()=>{if(!s())return;const e=Math.sin(Date.now()/(500*Math.PI)+200*s());n().y=Math.floor(60*e+60),r(Ft),setTimeout(p,50)},m=()=>{u()?l(0):(l(Math.random()),g())},g=()=>{if(!u())return;const e=Math.sin(Date.now()/(500*Math.PI)+200*u());n().z=Math.floor(60*e+60),r(Ft),setTimeout(g,50)},C=()=>{n().isActive?(n().noteOff(),r(Ft),i(0),a(0),l(0)):c()};return c(),(()=>{const e=Rt(),t=e.firstChild.nextSibling,r=t.nextSibling.nextSibling,i=r.nextSibling.nextSibling,a=i.nextSibling.nextSibling,l=a.nextSibling.nextSibling,c=l.nextSibling,d=c.nextSibling.nextSibling,p=d.nextSibling,g=p.nextSibling;return le(e,(()=>n().note),t),le(e,(()=>n().channel),r),le(e,(()=>n().x.toFixed(2)),i),le(e,(()=>n().y),a),le(e,(()=>n().z),l),c.$$click=C,le(c,(()=>n().isActive?"Stop Note":"Play Note")),d.$$click=h,le(d,(()=>o()?"Stop LFO X":"Start LFO X")),p.$$click=f,le(p,(()=>s()?"Stop LFO Y":"Start LFO Y")),g.$$click=m,le(g,(()=>u()?"Stop LFO Z":"Start LFO Z")),e})()},Kt=({output:e})=>{const t=new(0,ht.MPEMidivalOutput)(e,{lowerZoneSize:7,upperZoneSize:3}),n=[64,68,70];return(()=>{const e=Gt();return le(e,Q(te,{each:n,children:e=>Q(Zt,{value:e,mpe:t})})),e})()};se(["click"]);const Ut=ie("<div>Connect to following inputs to see MPE messages being sent:"),$t=ie("<div>Connect to following outputs to start sending MPE messages:"),Wt=ie("<div>");function qt(){const[e,t]=w(),[n,r]=w(),[o,i]=w();Me.MIDIVal.connect().then((e=>t((()=>e))));const s=e=>{r((()=>e))},a=e=>{i((()=>e))};return(()=>{const t=Wt();return le(t,Q(ne,{get when(){return O((()=>!(!e()||n())))()&&!o()},get children(){return[Ut(),Q(ve,{access:e,onSelect:s}),$t(),Q(ct,{access:e,onSelect:a})]}}),null),le(t,Q(ne,{get when(){return n()},get children(){return Q(st,{get input(){return n()}})}}),null),le(t,Q(ne,{get when(){return o()},get children(){return Q(Kt,{get output(){return o()}})}}),null),t})()}oe((()=>Q(qt,{})),document.getElementById("app"));
//# sourceMappingURL=index.fbb4081d.js.map
